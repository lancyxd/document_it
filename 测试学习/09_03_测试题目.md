### 1 混沌工程？

参考链接：
[混沌工程(Chaos Engineering) 总结](https://zhuanlan.zhihu.com/p/90294032)
[混沌工程(Chaos Engineering) 到底是什么?](https://cloud.tencent.com/developer/article/1622874)

[华为云在混沌工程场景下的可靠性测试](https://www.infoq.cn/article/Pjd8yVzrCbYkDZj8K9dt)

```shell
# 在混沌工程里面，如果步入深水区，需要面对的最困难的问题是什么？ 怎么解决解决？最好能举例子?



```

### 2  cpu满，应用程序如何优化？

```shell
# 在充分利用CPU的前提下，当一个后台应用的CPU使用率已经100%了，这个服务还可以从什么角度进行性能优化？
关注点: cpu、内存、磁盘、磁盘io、网络io
频繁读写 （insert mysql分批插入或者es数据入库也执行分批插入的操作）
程序死循环
```

### 3  基于线上压测？

```shell
# 基于线上正在运行的产品进行压力测试，会遇到什么具体问题，怎么解决？最好能举例子
低业务量的时间段进行。
垃圾数据做标记。脚本清理垃圾数据。
ip识别转发(5台机器跑线上的服务，我进行线上压测的时候，要做ip转发，只测试其中的两台或者3台做压测。留一部分机器来支撑正常业务)
```

### 4  网络及系统可靠性

```shell
1) 网络指令
top  按数字1，各个cpu的详细利用率。
vmstat -n 3 2  # 每隔3秒取样1次，共取样2次 (主要关注procs和cpu，r：运行和等待cpu时间片的进程数，一般来说整个系统的运行队列不超过总核数的2倍; b:等待进程的资源数;us + sy 参考值为 80% ，如果大于 80% 的话，说明可能存在 CPU 不足)
free -m 内存   # 比较容易看，结果相对精准
df -h          # 排查磁盘空间够不够
iostat -xdk 3 2 #磁盘io (-x: 显示详细信息  -d: 显示磁盘使用情况 -k: 以 KB 为单位显示)rkB/s ：每秒读取数据量 kB ；wkB/s ：每秒写入数据量 kB ；svctm ：I/O 请求的平均服务时间，单位毫秒；util ：一秒中有百分之几的时间用于 I/O 操作，如果接近 100% 说明磁盘带宽跑满了，这个时候就要优化程序或者增加磁盘了。
sar -n DEV 3 2 # 网络io (-n 采样次数，默认为1次) rxpck/s ：每秒钟接收的数据包；txpck/s ：每秒钟发送的数据包；rxKB/s ：每秒接收的数据量，单位 KByte
；txKB/s ：每秒发出的数据量，单位 KByte

2) 服务不可用原因？
cpu满负荷，竞争激烈，处理不过来，造成假死。
内存溢出，物理内存不够，造成应用程序内存申请不到，直接退出。
io文件描述符创建过多，消耗系统资源，应用程序申请不到系统资源。
带宽过载，上下行带宽超过限制或者打满网卡。
程序bug引起的系统不可用或者内存泄露、死循环。
服务器宕机
3) 保证系统稳定可靠的方案?
垂直扩展: 垂直扩展提升系统的处理能力，如加cpu、内存等，但不能解决单点故障。
水平扩展: 通过冗余部署，解决单点故障，同时提升系统的处理能力，提高高可用性。
隔离: 对系统、业务的占用资源进行隔离，限制某个业务的资源占用数，避免一个业务占用整个系统资源，对其他业务造成影响。 常用的隔离有：进程隔离、线程隔离、模块隔离、应用隔离、机房隔离等，读写分离。
解耦: 降低系统之间的依赖关系，避免系统之间互相影响造成雪崩。将同步调用转换成异步消息交互，通过消息队列解耦系统之间的 依赖关系。
限流：一个系统的处理能力是有上限的，当服务请求量超过处理能力，通常会引起排队，造成响应时间迅速提升。如果对服务占用的资源量没有约束，可能导致资源占用过多而宕机。常用的限流方式有消费者端限流，提供者端限流，网关限流，限流算法有滑动窗口、漏桶算法，令牌桶算法等。
降级：是牺牲非核心的业务功能，保证核心功能的稳定运行。实现优雅的业务降级，需要将功能实现拆分到相对独立的不同代码单元，分优先级进行隔离，在后台通过开关控制。
熔断：在分布式系统中，如果调用的远程服务失败或者不可用，就会导致请求阻塞在服务器上等待从而造成耗尽服务器资源，引起雪崩效应。采用熔断机制，即使控制故障范围扩大，保证系统整体上可用，局部不可用。

4) 死锁？两个或两个以上的进程在执行过程中，由于资源竞争或者彼此通信而造成的一种阻塞现象。
进程和线程都可以发生死锁，只要满足死锁的条件？ 互斥条件; 请求与保持; 不可剥夺; 循环等待。
避免死锁? 对多个资源、数据库表、对象同时加锁时，需要保持一致的加锁顺序，否则可能会 造成死锁。说明：线程一需要对表 A、B、C 依次全部加锁后才可以进行更新操作，那么线程二的加锁顺序也必须是 A、B、C，否则可能出现死锁。
```



